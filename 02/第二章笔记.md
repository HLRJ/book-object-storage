分布式系统三大特征
节点之间并发工作、没有全局锁、某个节点上发生的错误不影响其他节点

本章将解开接口和数据存储这两个耦合，让接口和数据存储成为互相独立的服务节点，就可以往集群中随意添加新的接口服务节点或数据服务节点。

接口服务和数据服务之间的接口有两种，第一种接口实现对象的存取，使用REST接口。
第二种接口通过RabbitMQ消息队列进行通信，对其使用分为两种模式，一种是一对多，另一种是一对一。

对象存取的特点是数据量有可能很大，不适合将一个巨大的对象通过消息队列传输，而REST接口虽然能够处理大数据量传输，对视对于群发却显得力不从心。

REST接口\
除了之前的PUT和GET方法之外，还需要提供一个定位的locate接口，用来帮助验证架构。\
GET /locate/<object_name>\
客户端通过GET方法发起对象定位请求，接口服务节点收到该请求后会向数据服务层群发一个定位消息，然后等待数据服务节点的反馈。\
如果有数据服务节点发回确认消息，则返回该数据服务节点的地址；如果超过一定时间没有任何反馈，则返回HTTP错误代码404NOT FOUND.\
RabbitMQ消息设计\
数据服务通过RabbitMQ将自身的存在通知给所有的接口服务，这样的消息被成为心跳消息。\
apiServers和dataServers这两个exchange需要在RabbitMQ服务器上预先创建。每个接口服务节点在启动后都会创建自己的消息队列并绑定至
apiServers exchange。每个数据服务节点在启动后每隔5s就会发送一条消息给apiServers exchange,消息的正文就是该数据服务节点的HTTP监听地址。
接口服务节点在收到该消息后就会记录这个地址。


